<!DOCTYPE html>
<html>
<head>
    <title></title>
    <style>
        #c {
            border: 1px solid black;
        }

        #tool {
            position: relative;
        }

        #penSetting {
            position: absolute;
            left: 0;
            top: 20px;
        }

        .wp-body {

        }
        .wp-header {
            display: inline-block;
            width:300px;
        }
    </style>
</head>
<body>
<div id="content">

</div>

<script src="jquery-1.10.2.js"></script>
<script>
    (function () {
        var arrayProto = Array.prototype,
            objectProto = Object.prototype,
            toString = objectProto.toString,
            hasOwn = objectProto.hasOwnProperty,
            arraySlice = arrayProto.slice,
            isFn = function(val){ return typeof val === 'function'; },
            win = window,
            doc = win.document,
            emptyFn = function () {
            },
            each = function (obj, cb, ctx) {
                if (!obj) {
                    return obj;
                }
                var i;
                if (obj && obj.push) {
                    if (obj.forEach) {
                        if (obj.forEach(cb, ctx) === false) {
                            return;
                        }
                    } else {
                        for (i = 0; i < obj.length; i++) {
                            if (cb.call(ctx || obj, obj[i], i, obj) === false) {
                                return;
                            }
                        }
                    }
                } else {
                    for (i in obj) {
                        if (hasOwn.call(obj, i)) {
                            if (cb.call(obj, obj[i], i, obj) === false) {
                                return;
                            }
                        }
                    }
                }
                return obj;
            },
            extend = function (obj) {
                each(arraySlice.call(arguments, 1), function (source) {
                    each(source, function (val, key) {
                        obj[key] = source[key];
                    });
                });
                return obj;
            };

        var Klass = (function(){
            function wrap(k, fn, supr) {
                return function () {
                    var tmp = this.callParent, ret;

                    this.callParent = supr.prototype[k];
                    ret = undefined;
                    try {
                        ret = fn.apply(this, arguments);
                    } finally {
                        this.callParent = tmp;
                    }
                    return ret;
                };
            }

            function inherits(what, o, supr) {
                each(o, function (v, k) {
                    what[k] = isFn(v) && isFn(supr.prototype[k]) ? wrap(k, v, supr) : v;
                });
            }

            var Klass = emptyFn,
                F = emptyFn;

            var classExtend = function(attr){
                var supr = this,
                    NewClass = function(){
                        if(this.initialize) {
                            return this.initialize.apply(this, arguments);
                        } else {
                            supr.prototype.initialize && supr.prototype.initialize.apply(this, arguments);
                        }
                    };

                F.prototype = supr.prototype;
                NewClass.prototype = new F;
                NewClass.prototype.constructor = NewClass;
                NewClass._super_ = supr.prototype;
                inherits(NewClass.prototype, attr, supr);
                return NewClass.extend = classExtend, NewClass;
            };
            return Klass.extend = classExtend, Klass;
        })();


        // 이벤트 리스너
        var UIClass = Klass.extend({
            initialize: function () {
                console.log(1);
                this._listeners = $({});
                this.$el = $(el);
                this.options = extend({}, this.defaults, options);
            },

            on: function () {
                var lsn = this._listeners;
                lsn.on.apply(lsn, arguments);
                return this;
            },

            once: function () {
                var lsn = this._listeners;
                lsn.once.apply(lsn, arguments);
                return this;
            },

            off: function () {
                var lsn = this._listeners;
                lsn.off.apply(lsn, arguments);
                return this;
            },

            trigger: function () {
                var lsn = this._listeners;
                lsn.trigger.apply(lsn, arguments);
                return this;
            }
        });

        // 펜 속성 선택
        var PenSettingDialog = UIClass.extend({
            initialize: function(el, options) {
                this.callParent(el, options);

                this.render();
            },
            render: function(){
                var html = '<div><div class="wp-header">Pen Setting</div></div>'
            }
        });

        var WebPainter = UIClass.extend({
            initialize: function(el, options) {
                console.log(2);
                this.render();
            },
            render: function(){
                var html = '<div class="wp-setting"">'
                        + '<button class="wp-btn-pen">펜</button>'
                        + '<div class="wp-color-picker" style="display: none;"></div>'
                        + '<button class="wp-btn-erase">Erase</button>'
                        + '<button class="wp-btn-undo">Undo</button>'
                        + '<button class="wp-btn-redo">Redo</button>'
                        + '</div>'
                        + '<canvas class="wp-canvas" width="500" height="300"></canvas>';
            }
        });

        window.WebPainter = WebPainter;

    })();
</script>
</body>
</html>